{"icons":{"src":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KCTxwYXRoIGQ9Ik0zMCA1QzMwIDIuMjM4NTggMjcuNzYxNCAwIDI1IDBINUMyLjIzODU4IDAgMCAyLjIzODU4IDAgNVYyMEg4MFYxNUM4MCAxMi4yMzg2IDc3Ljc2MTQgMTAgNzUgMTBIMzVDMzIuMjM4NiAxMCAzMCA3Ljc2MTQyIDMwIDVaIiBmaWxsPSJ1cmwoI3BhaW50MF9saW5lYXJfMl84KSIvPgoJPHBhdGggZD0iTTgwIDIwSDBWNTVDMCA1Ny43NjE0IDIuMjM4NTggNjAgNSA2MEg3NUM3Ny43NjE0IDYwIDgwIDU3Ljc2MTQgODAgNTVWMjBaIiBmaWxsPSJ1cmwoI3BhaW50MV9saW5lYXJfMl84KSIvPgoJCgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMl84IiB4MT0iNDAiIHkxPSIwIiB4Mj0iNDAiIHkyPSI2MCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCQk8c3RvcCBzdG9wLWNvbG9yPSIjRjZDQjdGIi8+CgkJCTxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzhDNkMzNCIvPgoJCTwvbGluZWFyR3JhZGllbnQ+CgkJCgkJPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDFfbGluZWFyXzJfOCIgeDE9IjQwIiB5MT0iMCIgeDI9IjQwIiB5Mj0iNjAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0VBQzg2MSIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNDMzhGMjUiLz4KCQk8L2xpbmVhckdyYWRpZW50PgoJPC9kZWZzPgo8L3N2Zz4K"},"js":"const {\n\tWindow, Element,\n\tFlexBox, Button, Image, ProgressBar,\n\thover\n} = await require(\"A:/apps/libs/gui.js\");\n\nconst mainContainer = new FlexBox(\"column\");\n\nfunction main() {\n\tconst window = new Window();\n\twindow.title = \"File Explorer\";\n\n\tconst root = new FlexBox(\"column\");\n\twindow.content = root;\n\n\tconst addressBarContainer = new FlexBox();\n\troot.append(addressBarContainer);\n\taddressBarContainer.gap = \"5px\";\n\n\tconst upBtn = new Button(\"up\");\n\taddressBarContainer.append(upBtn);\n\n\t// const addressBar = new Element(\"div\");\n\t// addressBar.css(\"flex\", \"1\");\n\t// addressBarContainer.append(addressBar);\n\n\troot.append(mainContainer);\n\tmainContainer.css(\"flex\", \"1\");\n\n\tupdate();\n}\n\nasync function update(path) {\n\tmainContainer.clear();\n\n\tif (!path) {\n\t\t\tconst driveNames = await sysget(\"fs.drives\");\n\n\t\t\tdriveNames.forEach(async (driveName) => {\n\t\t\t\t\tconst item = await driveItem(driveName);\n\t\t\t\t\tmainContainer.append(item);\n\t\t\t\t\titem.on(\"dblclick\", () => update(driveName) + '/');\n\t\t\t});\n\t} else {\n\t\t\tconst dir = await sysget(\"fs.open\", path, \"read\");\n\t\t\tconst entries = await sysget(\"fs.readdir\", dir);\n\t\t\tsyscall(\"fs.close\", dir);\n\n\t\t\tconst dirs = new FlexBox(\"column\")\n\t\t\tconst files = new FlexBox(\"column\")\n\n\t\t\tmainContainer.append(dirs);\n\t\t\tmainContainer.append(files);\n\n\t\t\tentries.forEach(async (name) => {\n\t\t\t\t\tconst fd = await sysget(\"fs.open\", path + name, \"read\");\n\t\t\t\t\tconst stat = await sysget(\"fs.stat\", fd);\n\t\t\t\t\tsyscall(\"fs.close\", fd);\n\n\t\t\t\t\tif (stat.type === \"dir\") {\n\t\t\t\t\t\t\tconst item = folderItem(name);\n\t\t\t\t\t\t\tdirs.append(item);\n\t\t\t\t\t\t\titem.on(\"dblclick\", () => update(path + name + \"/\"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst item = fileItem(name);\n\t\t\t\t\t\t\tfiles.append(item);\n\t\t\t\t\t}\n\t\t\t});\n\t}\n}\n\nasync function driveItem(driveName) {\n\tconst layout = new FlexBox();\n\tconst icon = new Image();\n\tconst name = new Element(\"span\");\n\tconst size = await sysget(\"fs.drive.size\", driveName);\n\tconst used = await sysget(\"fs.drive.used\", driveName);\n\tconst progress = (used / size) * 100;\n\tconst progressBar = new ProgressBar(progress);\n\tconst progressText = new Element(\"span\");\n\n\tlayout.append(icon);\n\tlayout.append(name);\n\tlayout.append(progressBar);\n\n\tlayout.css(\"padding\", \"10px\");\n\tlayout.css(\"cursor\", \"pointer\");\n\tlayout.css(\"align-items\", \"center\");\n\tlayout.gap = \"10px\";\n\n\ticon.src = \"A:/apps/icons/drive.svg\";\n\ticon.size = \"24px\";\n\n\tname.text = driveName;\n\tname.css(\"font-size\", \"1.2rem\");\n\tname.css(\"flex\", '1');\n\n\tprogressBar.css('display', 'flex');\n\n\tprogressText.text = `${round(formatBytes(used, \"B\"))} / ${round(formatBytes(size, \"B\"))}`;\n\tprogressText.css(\"padding-left\", \"10px\");\n\tprogressText.css(\"font-size\", \".8rem\");\n\t// progressText.css(\"color\", \"hsl(0 0 50)\");\n\tprogressText.css(\"align-self\", 'center');\n\tprogressBar.append(progressText);\n\n\thover(layout);\n\n\treturn layout;\n}\n\nfunction folderItem(name) {\n\tconst layout = new FlexBox();\n\tconst icon = new Image();\n\tconst nameEle = new Element(\"span\");\n\n\tlayout.append(icon);\n\tlayout.append(nameEle);\n\n\tlayout.css(\"padding\", \"10px\");\n\tlayout.css(\"cursor\", \"pointer\");\n\tlayout.css(\"align-items\", \"center\");\n\tlayout.gap = \"10px\";\n\n\ticon.src = \"A:/apps/icons/folder.svg\";\n\ticon.size = \"24px\";\n\n\tnameEle.text = name;\n\n\thover(layout);\n\treturn layout;\n}\n\nfunction fileItem(name) {\n\tconst layout = new FlexBox();\n\tconst icon = new Image();\n\tconst nameEle = new Element(\"span\");\n\n\tlayout.append(icon);\n\tlayout.append(nameEle);\n\n\tlayout.css(\"padding\", \"10px\");\n\tlayout.css(\"cursor\", \"pointer\");\n\tlayout.css(\"align-items\", \"center\");\n\tlayout.gap = \"10px\";\n\n\ticon.src = \"A:/apps/icons/file.svg\";\n\ticon.size = \"24px\";\n\n\tnameEle.text = name;\n\n\thover(layout);\n\treturn layout;\n}\n\nfunction formatBytes(num, unit) {\n\tif (num < 1024) return `${num} ${unit}`;\n\n\tif (unit === \"B\") return formatBytes(num / 1024, \"KB\");\n\tif (unit === \"KB\") return formatBytes(num / 1024, \"MB\");\n}\n\nfunction round(unitFormatted) {\n\tconst match = /(\\d+(?:\\.\\d+)?)( \\w+)/.exec(unitFormatted);\n\tif (!match) return unitFormatted;\n\treturn Math.round(parseFloat(match[1])) + match[2];\n}\n\nmain();"}